{
  "metadata": {
    "execution_started": "2026-01-31 16:15:03",
    "execution_completed": "2026-01-31 16:15:43",
    "total_tests": 20,
    "passed": 19,
    "failed": 1,
    "errors": 0
  },
  "test_results": [
    {
      "test_id": "QC001",
      "test_name": "Check Total Records Loaded",
      "test_type": "quality_check",
      "severity": "critical",
      "status": "failed",
      "execution_timestamp": "2026-01-31 16:15:06",
      "execution_time_seconds": 0.48,
      "execution_plan": {
        "test_id": "QC001",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer;"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 7
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 10}]"
        }
      ],
      "actual_result": "[{'count': 10}]",
      "expected_result": "7",
      "validation_message": "Failed: Expected 7, Got 1",
      "error_message": null
    },
    {
      "test_id": "QC002",
      "test_name": "Check Unique Customer IDs",
      "test_type": "quality_check",
      "severity": "critical",
      "status": "passed",
      "execution_timestamp": "2026-01-31 16:15:06",
      "execution_time_seconds": 0.34,
      "execution_plan": {
        "test_id": "QC002",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(customer_id) FROM dim_customer GROUP BY customer_id HAVING COUNT(*) > 1;"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 0
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 2}, {'count': 2}, {'count': 2}]"
        }
      ],
      "actual_result": "[{'count': 2}, {'count': 2}, {'count': 2}]",
      "expected_result": "None",
      "validation_message": "Query executed, results: [{'count': 2}, {'count': 2}, {'count': 2}]",
      "error_message": null
    },
    {
      "test_id": "QC003",
      "test_name": "Check Required Fields for NULL Values",
      "test_type": "quality_check",
      "severity": "high",
      "status": "passed",
      "execution_timestamp": "2026-01-31 16:15:06",
      "execution_time_seconds": 0.3,
      "execution_plan": {
        "test_id": "QC003",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id IS NULL OR effective_start_date IS NULL OR is_current IS NULL;"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 0
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 0}]"
        }
      ],
      "actual_result": "[{'count': 0}]",
      "expected_result": "None",
      "validation_message": "Query executed, results: [{'count': 0}]",
      "error_message": null
    },
    {
      "test_id": "QC004",
      "test_name": "Check Current Records per Customer",
      "test_type": "quality_check",
      "severity": "critical",
      "status": "passed",
      "execution_timestamp": "2026-01-31 16:15:07",
      "execution_time_seconds": 0.22,
      "execution_plan": {
        "test_id": "QC004",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT customer_id, COUNT(*) FROM dim_customer WHERE is_current = true GROUP BY customer_id HAVING COUNT(*) > 1;"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 0
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[]"
        }
      ],
      "actual_result": "[[]]",
      "expected_result": "None",
      "validation_message": "Query executed, results: []",
      "error_message": null
    },
    {
      "test_id": "QC005",
      "test_name": "Check Effective End Date for Current Records",
      "test_type": "quality_check",
      "severity": "high",
      "status": "passed",
      "execution_timestamp": "2026-01-31 16:15:07",
      "execution_time_seconds": 0.23,
      "execution_plan": {
        "test_id": "QC005",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE is_current = true AND effective_end_date IS NOT NULL;"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 0
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 0}]"
        }
      ],
      "actual_result": "[{'count': 0}]",
      "expected_result": "None",
      "validation_message": "Query executed, results: [{'count': 0}]",
      "error_message": null
    },
    {
      "test_id": "QC006",
      "test_name": "Check Effective Start and End Dates",
      "test_type": "quality_check",
      "severity": "high",
      "status": "passed",
      "execution_timestamp": "2026-01-31 16:15:07",
      "execution_time_seconds": 0.26,
      "execution_plan": {
        "test_id": "QC006",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE effective_end_date IS NOT NULL AND effective_end_date <= effective_start_date;"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 0
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 0}]"
        }
      ],
      "actual_result": "[{'count': 0}]",
      "expected_result": "None",
      "validation_message": "Query executed, results: [{'count': 0}]",
      "error_message": null
    },
    {
      "test_id": "QC007",
      "test_name": "Check Data Types of Columns",
      "test_type": "quality_check",
      "severity": "medium",
      "status": "passed",
      "execution_timestamp": "2026-01-31 16:15:07",
      "execution_time_seconds": 0.31,
      "execution_plan": {
        "test_id": "QC007",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE NOT (surrogate_key IS NOT NULL AND customer_id IS NOT NULL AND first_name IS NULL AND last_name IS NULL AND email IS NULL AND company_name IS NULL AND phone IS NULL AND effective_start_date IS NOT NULL AND (effective_end_date IS NULL OR effective_end_date > effective_start_date) AND is_current IS NOT NULL);"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 0
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 10}]"
        }
      ],
      "actual_result": "[{'count': 10}]",
      "expected_result": "None",
      "validation_message": "Query executed, results: [{'count': 10}]",
      "error_message": null
    },
    {
      "test_id": "QC008",
      "test_name": "Check Email Format",
      "test_type": "quality_check",
      "severity": "medium",
      "status": "passed",
      "execution_timestamp": "2026-01-31 16:15:08",
      "execution_time_seconds": 0.41,
      "execution_plan": {
        "test_id": "QC008",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE email !~ '^[^@]+@[^@]+\\.[^@]+$';"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 0
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 0}]"
        }
      ],
      "actual_result": "[{'count': 0}]",
      "expected_result": "None",
      "validation_message": "Query executed, results: [{'count': 0}]",
      "error_message": null
    },
    {
      "test_id": "QC009",
      "test_name": "Check Phone Number Format",
      "test_type": "quality_check",
      "severity": "medium",
      "status": "passed",
      "execution_timestamp": "2026-01-31 16:15:08",
      "execution_time_seconds": 0.23,
      "execution_plan": {
        "test_id": "QC009",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE phone !~ '^\\d{3}-\\d{4}$';"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 0
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 0}]"
        }
      ],
      "actual_result": "[{'count': 0}]",
      "expected_result": "None",
      "validation_message": "Query executed, results: [{'count': 0}]",
      "error_message": null
    },
    {
      "test_id": "QC010",
      "test_name": "Check for Duplicate Surrogate Keys",
      "test_type": "quality_check",
      "severity": "critical",
      "status": "passed",
      "execution_timestamp": "2026-01-31 16:15:08",
      "execution_time_seconds": 0.23,
      "execution_plan": {
        "test_id": "QC010",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT surrogate_key, COUNT(*) FROM dim_customer GROUP BY surrogate_key HAVING COUNT(*) > 1;"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 0
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[]"
        }
      ],
      "actual_result": "[[]]",
      "expected_result": "None",
      "validation_message": "Query executed, results: []",
      "error_message": null
    },
    {
      "test_id": "QC011",
      "test_name": "Check Created At and Updated At Timestamps",
      "test_type": "quality_check",
      "severity": "medium",
      "status": "passed",
      "execution_timestamp": "2026-01-31 16:15:09",
      "execution_time_seconds": 0.23,
      "execution_plan": {
        "test_id": "QC011",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE updated_at < created_at;"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 0
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 0}]"
        }
      ],
      "actual_result": "[{'count': 0}]",
      "expected_result": "None",
      "validation_message": "Query executed, results: [{'count': 0}]",
      "error_message": null
    },
    {
      "test_id": "QC012",
      "test_name": "Check Company Name Consistency",
      "test_type": "quality_check",
      "severity": "medium",
      "status": "passed",
      "execution_timestamp": "2026-01-31 16:15:09",
      "execution_time_seconds": 0.33,
      "execution_plan": {
        "test_id": "QC012",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE company_name IS NULL OR company_name = '';"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 0
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 0}]"
        }
      ],
      "actual_result": "[{'count': 0}]",
      "expected_result": "None",
      "validation_message": "Query executed, results: [{'count': 0}]",
      "error_message": null
    },
    {
      "test_id": "SC001",
      "test_name": "New Customer Insertion",
      "test_type": "scenario_check",
      "severity": "high",
      "status": "passed",
      "execution_timestamp": "2026-01-31 16:15:09",
      "execution_time_seconds": 3.54,
      "execution_plan": {
        "test_id": "SC001",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "create_backup",
            "parameters": {},
            "description": "Backup current table state"
          },
          {
            "step_number": 2,
            "method": "create_temp_input_file",
            "parameters": {
              "input_data": [
                {
                  "customer_id": "C006",
                  "first_name": "Alice",
                  "last_name": "Johnson",
                  "email": "alice.johnson@email.com",
                  "company_name": "NewWave Corp",
                  "phone": "555-0106"
                }
              ]
            },
            "description": "Create temp input file with test data"
          },
          {
            "step_number": 3,
            "method": "run_etl_pipeline",
            "parameters": {
              "source_file": null
            },
            "description": "Run ETL pipeline with test data"
          },
          {
            "step_number": 4,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id = 'C006' AND is_current = true;"
            },
            "description": "Validation query 1"
          },
          {
            "step_number": 5,
            "method": "cleanup_temp_file",
            "parameters": {},
            "description": "Cleanup temp files"
          },
          {
            "step_number": 6,
            "method": "restore_from_backup",
            "parameters": {},
            "description": "Restore table from backup"
          }
        ],
        "validation": {
          "method": "check_outcome",
          "expected": "A new record for customer C006 is inserted into dim_customer with is_current set to true."
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "create_backup",
          "success": true,
          "result": "Backup created"
        },
        {
          "step_number": 2,
          "method": "create_temp_input_file",
          "success": true,
          "result": "Temp file created"
        },
        {
          "step_number": 3,
          "method": "run_etl_pipeline",
          "success": true,
          "result": "{'inserted': 0, 'updated_scd2': 1, 'updated_scd1': 0, 'unchanged': 0}"
        },
        {
          "step_number": 4,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 1}]"
        },
        {
          "step_number": 5,
          "method": "cleanup_temp_file",
          "success": true,
          "result": "Temp file removed"
        },
        {
          "step_number": 6,
          "method": "restore_from_backup",
          "success": true,
          "result": "Table restored"
        }
      ],
      "actual_result": "[{'count': 1}]",
      "expected_result": "A new record for customer C006 is inserted into dim_customer with is_current set to true.",
      "validation_message": "Validation passed: Found 1 records",
      "error_message": null
    },
    {
      "test_id": "SC002",
      "test_name": "Company Name Change (SCD Type 2)",
      "test_type": "scenario_check",
      "severity": "high",
      "status": "passed",
      "execution_timestamp": "2026-01-31 16:15:13",
      "execution_time_seconds": 4.55,
      "execution_plan": {
        "test_id": "SC002",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "create_backup",
            "parameters": {},
            "description": "Backup current table state"
          },
          {
            "step_number": 2,
            "method": "create_temp_input_file",
            "parameters": {
              "input_data": [
                {
                  "customer_id": "C001",
                  "first_name": "John",
                  "last_name": "Doe",
                  "email": "john.doe@email.com",
                  "company_name": "NewTech Industries",
                  "phone": "555-0101"
                }
              ]
            },
            "description": "Create temp input file with test data"
          },
          {
            "step_number": 3,
            "method": "run_etl_pipeline",
            "parameters": {
              "source_file": null
            },
            "description": "Run ETL pipeline with test data"
          },
          {
            "step_number": 4,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id = 'C001' AND is_current = true;"
            },
            "description": "Validation query 1"
          },
          {
            "step_number": 5,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id = 'C001' AND is_current = false;"
            },
            "description": "Validation query 2"
          },
          {
            "step_number": 6,
            "method": "cleanup_temp_file",
            "parameters": {},
            "description": "Cleanup temp files"
          },
          {
            "step_number": 7,
            "method": "restore_from_backup",
            "parameters": {},
            "description": "Restore table from backup"
          }
        ],
        "validation": {
          "method": "check_outcome",
          "expected": "A new record for customer C001 is created with the new company name, and the previous record's is_current is set to false."
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "create_backup",
          "success": true,
          "result": "Backup created"
        },
        {
          "step_number": 2,
          "method": "create_temp_input_file",
          "success": true,
          "result": "Temp file created"
        },
        {
          "step_number": 3,
          "method": "run_etl_pipeline",
          "success": true,
          "result": "{'inserted': 0, 'updated_scd2': 1, 'updated_scd1': 0, 'unchanged': 0}"
        },
        {
          "step_number": 4,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 1}]"
        },
        {
          "step_number": 5,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 2}]"
        },
        {
          "step_number": 6,
          "method": "cleanup_temp_file",
          "success": true,
          "result": "Temp file removed"
        },
        {
          "step_number": 7,
          "method": "restore_from_backup",
          "success": true,
          "result": "Table restored"
        }
      ],
      "actual_result": "[{'count': 2}]",
      "expected_result": "A new record for customer C001 is created with the new company name, and the previous record's is_current is set to false.",
      "validation_message": "Validation passed: Found 1 records",
      "error_message": null
    },
    {
      "test_id": "SC003",
      "test_name": "Name/Email/Phone Change (SCD Type 1)",
      "test_type": "scenario_check",
      "severity": "medium",
      "status": "passed",
      "execution_timestamp": "2026-01-31 16:15:17",
      "execution_time_seconds": 4.02,
      "execution_plan": {
        "test_id": "SC003",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "create_backup",
            "parameters": {},
            "description": "Backup current table state"
          },
          {
            "step_number": 2,
            "method": "create_temp_input_file",
            "parameters": {
              "input_data": [
                {
                  "customer_id": "C002",
                  "first_name": "Jane",
                  "last_name": "Doe",
                  "email": "jane.doe@email.com",
                  "company_name": "MegaData Corp",
                  "phone": "555-0102"
                }
              ]
            },
            "description": "Create temp input file with test data"
          },
          {
            "step_number": 3,
            "method": "run_etl_pipeline",
            "parameters": {
              "source_file": null
            },
            "description": "Run ETL pipeline with test data"
          },
          {
            "step_number": 4,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT first_name, last_name, email FROM dim_customer WHERE customer_id = 'C002';"
            },
            "description": "Validation query 1"
          },
          {
            "step_number": 5,
            "method": "cleanup_temp_file",
            "parameters": {},
            "description": "Cleanup temp files"
          },
          {
            "step_number": 6,
            "method": "restore_from_backup",
            "parameters": {},
            "description": "Restore table from backup"
          }
        ],
        "validation": {
          "method": "check_outcome",
          "expected": "The existing record for customer C002 is updated with the new first name, last name, and email."
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "create_backup",
          "success": true,
          "result": "Backup created"
        },
        {
          "step_number": 2,
          "method": "create_temp_input_file",
          "success": true,
          "result": "Temp file created"
        },
        {
          "step_number": 3,
          "method": "run_etl_pipeline",
          "success": true,
          "result": "{'inserted': 0, 'updated_scd2': 0, 'updated_scd1': 1, 'unchanged': 0}"
        },
        {
          "step_number": 4,
          "method": "execute_query",
          "success": true,
          "result": "[{'first_name': 'Jane', 'last_name': 'Smith', 'email': 'jane.smith@email.com'}, {'first_name': 'Jane', 'last_name': 'Doe', 'email': 'jane.doe@email.com'}]"
        },
        {
          "step_number": 5,
          "method": "cleanup_temp_file",
          "success": true,
          "result": "Temp file removed"
        },
        {
          "step_number": 6,
          "method": "restore_from_backup",
          "success": true,
          "result": "Table restored"
        }
      ],
      "actual_result": "[{'first_name': 'Jane', 'last_name': 'Smith', 'email': 'jane.smith@email.com'}, {'first_name': 'Jane', 'last_name': 'Doe', 'email': 'jane.doe@email.com'}]",
      "expected_result": "The existing record for customer C002 is updated with the new first name, last name, and email.",
      "validation_message": "Validation passed: Found 2 records",
      "error_message": null
    },
    {
      "test_id": "SC004",
      "test_name": "Combined Type 1 + Type 2 Changes",
      "test_type": "scenario_check",
      "severity": "high",
      "status": "passed",
      "execution_timestamp": "2026-01-31 16:15:21",
      "execution_time_seconds": 4.38,
      "execution_plan": {
        "test_id": "SC004",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "create_backup",
            "parameters": {},
            "description": "Backup current table state"
          },
          {
            "step_number": 2,
            "method": "create_temp_input_file",
            "parameters": {
              "input_data": [
                {
                  "customer_id": "C003",
                  "first_name": "Michael",
                  "last_name": "Smith",
                  "email": "michael.smith@email.com",
                  "company_name": "CloudBase Systems",
                  "phone": "555-0103"
                }
              ]
            },
            "description": "Create temp input file with test data"
          },
          {
            "step_number": 3,
            "method": "run_etl_pipeline",
            "parameters": {
              "source_file": null
            },
            "description": "Run ETL pipeline with test data"
          },
          {
            "step_number": 4,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id = 'C003' AND is_current = true;"
            },
            "description": "Validation query 1"
          },
          {
            "step_number": 5,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id = 'C003' AND is_current = false;"
            },
            "description": "Validation query 2"
          },
          {
            "step_number": 6,
            "method": "cleanup_temp_file",
            "parameters": {},
            "description": "Cleanup temp files"
          },
          {
            "step_number": 7,
            "method": "restore_from_backup",
            "parameters": {},
            "description": "Restore table from backup"
          }
        ],
        "validation": {
          "method": "check_outcome",
          "expected": "A new record for customer C003 is created with the new company name, and the previous record's is_current is set to false. The name and email are updated in the new record."
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "create_backup",
          "success": true,
          "result": "Backup created"
        },
        {
          "step_number": 2,
          "method": "create_temp_input_file",
          "success": true,
          "result": "Temp file created"
        },
        {
          "step_number": 3,
          "method": "run_etl_pipeline",
          "success": true,
          "result": "{'inserted': 0, 'updated_scd2': 0, 'updated_scd1': 1, 'unchanged': 0}"
        },
        {
          "step_number": 4,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 1}]"
        },
        {
          "step_number": 5,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 0}]"
        },
        {
          "step_number": 6,
          "method": "cleanup_temp_file",
          "success": true,
          "result": "Temp file removed"
        },
        {
          "step_number": 7,
          "method": "restore_from_backup",
          "success": true,
          "result": "Table restored"
        }
      ],
      "actual_result": "[{'count': 0}]",
      "expected_result": "A new record for customer C003 is created with the new company name, and the previous record's is_current is set to false. The name and email are updated in the new record.",
      "validation_message": "Validation passed: Found 1 records",
      "error_message": null
    },
    {
      "test_id": "SC005",
      "test_name": "Multiple Sequential Changes to Same Customer",
      "test_type": "scenario_check",
      "severity": "high",
      "status": "passed",
      "execution_timestamp": "2026-01-31 16:15:26",
      "execution_time_seconds": 5.53,
      "execution_plan": {
        "test_id": "SC005",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "create_backup",
            "parameters": {},
            "description": "Backup current table state"
          },
          {
            "step_number": 2,
            "method": "create_temp_input_file",
            "parameters": {
              "input_data": [
                {
                  "customer_id": "C001",
                  "first_name": "John",
                  "last_name": "Doe",
                  "email": "john.doe@email.com",
                  "company_name": "TechCorp Inc",
                  "phone": "555-0101"
                },
                {
                  "customer_id": "C001",
                  "first_name": "John",
                  "last_name": "Doe",
                  "email": "john.doe@email.com",
                  "company_name": "NeoTech Industries",
                  "phone": "555-0101"
                }
              ]
            },
            "description": "Create temp input file with test data"
          },
          {
            "step_number": 3,
            "method": "run_etl_pipeline",
            "parameters": {
              "source_file": null
            },
            "description": "Run ETL pipeline with test data"
          },
          {
            "step_number": 4,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id = 'C001' AND is_current = true;"
            },
            "description": "Validation query 1"
          },
          {
            "step_number": 5,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id = 'C001' AND is_current = false;"
            },
            "description": "Validation query 2"
          },
          {
            "step_number": 6,
            "method": "cleanup_temp_file",
            "parameters": {},
            "description": "Cleanup temp files"
          },
          {
            "step_number": 7,
            "method": "restore_from_backup",
            "parameters": {},
            "description": "Restore table from backup"
          }
        ],
        "validation": {
          "method": "check_outcome",
          "expected": "Two records for customer C001 are created: the first with TechCorp Inc and the second with NeoTech Industries, with the first marked as not current."
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "create_backup",
          "success": true,
          "result": "Backup created"
        },
        {
          "step_number": 2,
          "method": "create_temp_input_file",
          "success": true,
          "result": "Temp file created"
        },
        {
          "step_number": 3,
          "method": "run_etl_pipeline",
          "success": true,
          "result": "{'inserted': 0, 'updated_scd2': 2, 'updated_scd1': 0, 'unchanged': 0}"
        },
        {
          "step_number": 4,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 1}]"
        },
        {
          "step_number": 5,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 3}]"
        },
        {
          "step_number": 6,
          "method": "cleanup_temp_file",
          "success": true,
          "result": "Temp file removed"
        },
        {
          "step_number": 7,
          "method": "restore_from_backup",
          "success": true,
          "result": "Table restored"
        }
      ],
      "actual_result": "[{'count': 3}]",
      "expected_result": "Two records for customer C001 are created: the first with TechCorp Inc and the second with NeoTech Industries, with the first marked as not current.",
      "validation_message": "Validation passed: Found 1 records",
      "error_message": null
    },
    {
      "test_id": "SC006",
      "test_name": "Unchanged Records (No Updates)",
      "test_type": "scenario_check",
      "severity": "medium",
      "status": "passed",
      "execution_timestamp": "2026-01-31 16:15:31",
      "execution_time_seconds": 3.29,
      "execution_plan": {
        "test_id": "SC006",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "create_backup",
            "parameters": {},
            "description": "Backup current table state"
          },
          {
            "step_number": 2,
            "method": "create_temp_input_file",
            "parameters": {
              "input_data": [
                {
                  "customer_id": "C003",
                  "first_name": "Michael",
                  "last_name": "Johnson",
                  "email": "michael.j@email.com",
                  "company_name": "CloudBase Systems",
                  "phone": "555-0103"
                }
              ]
            },
            "description": "Create temp input file with test data"
          },
          {
            "step_number": 3,
            "method": "run_etl_pipeline",
            "parameters": {
              "source_file": null
            },
            "description": "Run ETL pipeline with test data"
          },
          {
            "step_number": 4,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id = 'C003';"
            },
            "description": "Validation query 1"
          },
          {
            "step_number": 5,
            "method": "cleanup_temp_file",
            "parameters": {},
            "description": "Cleanup temp files"
          },
          {
            "step_number": 6,
            "method": "restore_from_backup",
            "parameters": {},
            "description": "Restore table from backup"
          }
        ],
        "validation": {
          "method": "check_outcome",
          "expected": "The record for customer C003 remains unchanged, and no new records are created."
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "create_backup",
          "success": true,
          "result": "Backup created"
        },
        {
          "step_number": 2,
          "method": "create_temp_input_file",
          "success": true,
          "result": "Temp file created"
        },
        {
          "step_number": 3,
          "method": "run_etl_pipeline",
          "success": true,
          "result": "{'inserted': 0, 'updated_scd2': 0, 'updated_scd1': 0, 'unchanged': 1}"
        },
        {
          "step_number": 4,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 1}]"
        },
        {
          "step_number": 5,
          "method": "cleanup_temp_file",
          "success": true,
          "result": "Temp file removed"
        },
        {
          "step_number": 6,
          "method": "restore_from_backup",
          "success": true,
          "result": "Table restored"
        }
      ],
      "actual_result": "[{'count': 1}]",
      "expected_result": "The record for customer C003 remains unchanged, and no new records are created.",
      "validation_message": "Validation passed: Found 1 records",
      "error_message": null
    },
    {
      "test_id": "SC007",
      "test_name": "New Customer + Existing Customer Updates in Same File",
      "test_type": "scenario_check",
      "severity": "high",
      "status": "passed",
      "execution_timestamp": "2026-01-31 16:15:34",
      "execution_time_seconds": 4.5,
      "execution_plan": {
        "test_id": "SC007",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "create_backup",
            "parameters": {},
            "description": "Backup current table state"
          },
          {
            "step_number": 2,
            "method": "create_temp_input_file",
            "parameters": {
              "input_data": [
                {
                  "customer_id": "C007",
                  "first_name": "Alice",
                  "last_name": "Brown",
                  "email": "alice.brown@email.com",
                  "company_name": "FutureTech",
                  "phone": "555-0107"
                },
                {
                  "customer_id": "C002",
                  "first_name": "Jane",
                  "last_name": "Doe",
                  "email": "jane.doe@email.com",
                  "company_name": "MegaData Corp",
                  "phone": "555-0102"
                }
              ]
            },
            "description": "Create temp input file with test data"
          },
          {
            "step_number": 3,
            "method": "run_etl_pipeline",
            "parameters": {
              "source_file": null
            },
            "description": "Run ETL pipeline with test data"
          },
          {
            "step_number": 4,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id = 'C007';"
            },
            "description": "Validation query 1"
          },
          {
            "step_number": 5,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT first_name, last_name FROM dim_customer WHERE customer_id = 'C002';"
            },
            "description": "Validation query 2"
          },
          {
            "step_number": 6,
            "method": "cleanup_temp_file",
            "parameters": {},
            "description": "Cleanup temp files"
          },
          {
            "step_number": 7,
            "method": "restore_from_backup",
            "parameters": {},
            "description": "Restore table from backup"
          }
        ],
        "validation": {
          "method": "check_outcome",
          "expected": "A new record for customer C007 is created, and the existing record for C002 is updated with the new name."
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "create_backup",
          "success": true,
          "result": "Backup created"
        },
        {
          "step_number": 2,
          "method": "create_temp_input_file",
          "success": true,
          "result": "Temp file created"
        },
        {
          "step_number": 3,
          "method": "run_etl_pipeline",
          "success": true,
          "result": "{'inserted': 0, 'updated_scd2': 1, 'updated_scd1': 1, 'unchanged': 0}"
        },
        {
          "step_number": 4,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 2}]"
        },
        {
          "step_number": 5,
          "method": "execute_query",
          "success": true,
          "result": "[{'first_name': 'Jane', 'last_name': 'Smith'}, {'first_name': 'Jane', 'last_name': 'Doe'}]"
        },
        {
          "step_number": 6,
          "method": "cleanup_temp_file",
          "success": true,
          "result": "Temp file removed"
        },
        {
          "step_number": 7,
          "method": "restore_from_backup",
          "success": true,
          "result": "Table restored"
        }
      ],
      "actual_result": "[{'first_name': 'Jane', 'last_name': 'Smith'}, {'first_name': 'Jane', 'last_name': 'Doe'}]",
      "expected_result": "A new record for customer C007 is created, and the existing record for C002 is updated with the new name.",
      "validation_message": "Validation passed: Found 2 records",
      "error_message": null
    },
    {
      "test_id": "SC008",
      "test_name": "Edge Cases (Empty Values, Special Characters)",
      "test_type": "scenario_check",
      "severity": "medium",
      "status": "passed",
      "execution_timestamp": "2026-01-31 16:15:39",
      "execution_time_seconds": 4.19,
      "execution_plan": {
        "test_id": "SC008",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "create_backup",
            "parameters": {},
            "description": "Backup current table state"
          },
          {
            "step_number": 2,
            "method": "create_temp_input_file",
            "parameters": {
              "input_data": [
                {
                  "customer_id": "C008",
                  "first_name": "",
                  "last_name": "O'Reilly",
                  "email": "o'reilly@email.com",
                  "company_name": "EdgeCase Inc",
                  "phone": "555-0108"
                }
              ]
            },
            "description": "Create temp input file with test data"
          },
          {
            "step_number": 3,
            "method": "run_etl_pipeline",
            "parameters": {
              "source_file": null
            },
            "description": "Run ETL pipeline with test data"
          },
          {
            "step_number": 4,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id = 'C008';"
            },
            "description": "Validation query 1"
          },
          {
            "step_number": 5,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT first_name, last_name FROM dim_customer WHERE customer_id = 'C008';"
            },
            "description": "Validation query 2"
          },
          {
            "step_number": 6,
            "method": "cleanup_temp_file",
            "parameters": {},
            "description": "Cleanup temp files"
          },
          {
            "step_number": 7,
            "method": "restore_from_backup",
            "parameters": {},
            "description": "Restore table from backup"
          }
        ],
        "validation": {
          "method": "check_outcome",
          "expected": "A new record for customer C008 is created with the first name as empty and the last name containing a special character."
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "create_backup",
          "success": true,
          "result": "Backup created"
        },
        {
          "step_number": 2,
          "method": "create_temp_input_file",
          "success": true,
          "result": "Temp file created"
        },
        {
          "step_number": 3,
          "method": "run_etl_pipeline",
          "success": true,
          "result": "{'inserted': 1, 'updated_scd2': 0, 'updated_scd1': 0, 'unchanged': 0}"
        },
        {
          "step_number": 4,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 1}]"
        },
        {
          "step_number": 5,
          "method": "execute_query",
          "success": true,
          "result": "[{'first_name': '', 'last_name': \"O'Reilly\"}]"
        },
        {
          "step_number": 6,
          "method": "cleanup_temp_file",
          "success": true,
          "result": "Temp file removed"
        },
        {
          "step_number": 7,
          "method": "restore_from_backup",
          "success": true,
          "result": "Table restored"
        }
      ],
      "actual_result": "[{'first_name': '', 'last_name': \"O'Reilly\"}]",
      "expected_result": "A new record for customer C008 is created with the first name as empty and the last name containing a special character.",
      "validation_message": "Validation passed: Found 1 records",
      "error_message": null
    }
  ]
}