{
  "metadata": {
    "execution_started": "2026-01-31 15:28:30",
    "execution_completed": "2026-01-31 15:29:35",
    "total_tests": 20,
    "passed": 19,
    "failed": 1,
    "errors": 0
  },
  "test_results": [
    {
      "test_id": "QC001",
      "test_name": "Check Total Records Loaded",
      "test_type": "quality_check",
      "severity": "critical",
      "status": "failed",
      "execution_timestamp": "2026-01-31 15:28:33",
      "execution_time_seconds": 0.71,
      "execution_plan": {
        "test_id": "QC001",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer;"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 7
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 10}]"
        }
      ],
      "actual_result": "[{'count': 10}]",
      "expected_result": "7",
      "validation_message": "Failed: Expected 7, Got 1",
      "error_message": null
    },
    {
      "test_id": "QC002",
      "test_name": "Check Primary Key Uniqueness",
      "test_type": "quality_check",
      "severity": "critical",
      "status": "passed",
      "execution_timestamp": "2026-01-31 15:28:33",
      "execution_time_seconds": 0.29,
      "execution_plan": {
        "test_id": "QC002",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT customer_id, COUNT(*) FROM dim_customer GROUP BY customer_id HAVING COUNT(*) > 1;"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 0
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[{'customer_id': 'C004', 'count': 2}, {'customer_id': 'C002', 'count': 2}, {'customer_id': 'C001', 'count': 2}]"
        }
      ],
      "actual_result": "[{'customer_id': 'C004', 'count': 2}, {'customer_id': 'C002', 'count': 2}, {'customer_id': 'C001', 'count': 2}]",
      "expected_result": "None",
      "validation_message": "Query executed, results: [{'customer_id': 'C004', 'count': 2}, {'customer_id': 'C002', 'count': 2}, {'customer_id': 'C001', 'count': 2}]",
      "error_message": null
    },
    {
      "test_id": "QC003",
      "test_name": "Check Required Fields for NULLs",
      "test_type": "quality_check",
      "severity": "critical",
      "status": "passed",
      "execution_timestamp": "2026-01-31 15:28:34",
      "execution_time_seconds": 0.25,
      "execution_plan": {
        "test_id": "QC003",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id IS NULL OR effective_start_date IS NULL OR is_current IS NULL;"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 0
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 0}]"
        }
      ],
      "actual_result": "[{'count': 0}]",
      "expected_result": "None",
      "validation_message": "Query executed, results: [{'count': 0}]",
      "error_message": null
    },
    {
      "test_id": "QC004",
      "test_name": "Check Current Record Constraint",
      "test_type": "quality_check",
      "severity": "high",
      "status": "passed",
      "execution_timestamp": "2026-01-31 15:28:34",
      "execution_time_seconds": 0.43,
      "execution_plan": {
        "test_id": "QC004",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT customer_id, COUNT(*) FROM dim_customer WHERE is_current = true GROUP BY customer_id HAVING COUNT(*) > 1;"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 0
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[]"
        }
      ],
      "actual_result": "[[]]",
      "expected_result": "None",
      "validation_message": "Query executed, results: []",
      "error_message": null
    },
    {
      "test_id": "QC005",
      "test_name": "Check Effective End Date for Current Records",
      "test_type": "quality_check",
      "severity": "high",
      "status": "passed",
      "execution_timestamp": "2026-01-31 15:28:34",
      "execution_time_seconds": 0.27,
      "execution_plan": {
        "test_id": "QC005",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE is_current = true AND effective_end_date IS NOT NULL;"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 0
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 0}]"
        }
      ],
      "actual_result": "[{'count': 0}]",
      "expected_result": "None",
      "validation_message": "Query executed, results: [{'count': 0}]",
      "error_message": null
    },
    {
      "test_id": "QC006",
      "test_name": "Check Effective Start Date Validity",
      "test_type": "quality_check",
      "severity": "medium",
      "status": "passed",
      "execution_timestamp": "2026-01-31 15:28:35",
      "execution_time_seconds": 0.27,
      "execution_plan": {
        "test_id": "QC006",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE effective_start_date > NOW();"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 0
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 2}]"
        }
      ],
      "actual_result": "[{'count': 2}]",
      "expected_result": "None",
      "validation_message": "Query executed, results: [{'count': 2}]",
      "error_message": null
    },
    {
      "test_id": "QC007",
      "test_name": "Check Data Types for Customer ID",
      "test_type": "quality_check",
      "severity": "medium",
      "status": "passed",
      "execution_timestamp": "2026-01-31 15:28:35",
      "execution_time_seconds": 0.44,
      "execution_plan": {
        "test_id": "QC007",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id IS NOT NULL AND NOT (customer_id ~ '^[A-Za-z0-9]+$');"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 0
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 0}]"
        }
      ],
      "actual_result": "[{'count': 0}]",
      "expected_result": "None",
      "validation_message": "Query executed, results: [{'count': 0}]",
      "error_message": null
    },
    {
      "test_id": "QC008",
      "test_name": "Check Email Format",
      "test_type": "quality_check",
      "severity": "high",
      "status": "passed",
      "execution_timestamp": "2026-01-31 15:28:35",
      "execution_time_seconds": 0.32,
      "execution_plan": {
        "test_id": "QC008",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE email IS NOT NULL AND NOT (email ~ '^[^@]+@[^@]+\\.[^@]+$');"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 0
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 0}]"
        }
      ],
      "actual_result": "[{'count': 0}]",
      "expected_result": "None",
      "validation_message": "Query executed, results: [{'count': 0}]",
      "error_message": null
    },
    {
      "test_id": "QC009",
      "test_name": "Check Phone Number Format",
      "test_type": "quality_check",
      "severity": "medium",
      "status": "passed",
      "execution_timestamp": "2026-01-31 15:28:36",
      "execution_time_seconds": 0.26,
      "execution_plan": {
        "test_id": "QC009",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE phone IS NOT NULL AND NOT (phone ~ '^\\d{3}-\\d{4}$');"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 0
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 0}]"
        }
      ],
      "actual_result": "[{'count': 0}]",
      "expected_result": "None",
      "validation_message": "Query executed, results: [{'count': 0}]",
      "error_message": null
    },
    {
      "test_id": "QC010",
      "test_name": "Check Company Name Completeness",
      "test_type": "quality_check",
      "severity": "medium",
      "status": "passed",
      "execution_timestamp": "2026-01-31 15:28:36",
      "execution_time_seconds": 0.98,
      "execution_plan": {
        "test_id": "QC010",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE company_name IS NULL;"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 0
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 0}]"
        }
      ],
      "actual_result": "[{'count': 0}]",
      "expected_result": "None",
      "validation_message": "Query executed, results: [{'count': 0}]",
      "error_message": null
    },
    {
      "test_id": "QC011",
      "test_name": "Check Creation and Update Timestamps",
      "test_type": "quality_check",
      "severity": "medium",
      "status": "passed",
      "execution_timestamp": "2026-01-31 15:28:37",
      "execution_time_seconds": 1.26,
      "execution_plan": {
        "test_id": "QC011",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE created_at IS NULL OR updated_at IS NULL OR created_at > updated_at;"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 0
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 0}]"
        }
      ],
      "actual_result": "[{'count': 0}]",
      "expected_result": "None",
      "validation_message": "Query executed, results: [{'count': 0}]",
      "error_message": null
    },
    {
      "test_id": "QC012",
      "test_name": "Check for Duplicate Surrogate Keys",
      "test_type": "quality_check",
      "severity": "critical",
      "status": "passed",
      "execution_timestamp": "2026-01-31 15:28:38",
      "execution_time_seconds": 0.25,
      "execution_plan": {
        "test_id": "QC012",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT surrogate_key, COUNT(*) FROM dim_customer GROUP BY surrogate_key HAVING COUNT(*) > 1;"
            },
            "description": "Execute validation query"
          }
        ],
        "validation": {
          "method": "compare_result",
          "expected": 0
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "execute_query",
          "success": true,
          "result": "[]"
        }
      ],
      "actual_result": "[[]]",
      "expected_result": "None",
      "validation_message": "Query executed, results: []",
      "error_message": null
    },
    {
      "test_id": "SC001",
      "test_name": "New Customer Insertion",
      "test_type": "scenario_check",
      "severity": "critical",
      "status": "passed",
      "execution_timestamp": "2026-01-31 15:28:38",
      "execution_time_seconds": 7.44,
      "execution_plan": {
        "test_id": "SC001",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "create_backup",
            "parameters": {},
            "description": "Backup current table state"
          },
          {
            "step_number": 2,
            "method": "create_temp_input_file",
            "parameters": {
              "input_data": [
                {
                  "customer_id": "C006",
                  "first_name": "Alice",
                  "last_name": "Green",
                  "email": "alice.green@email.com",
                  "company_name": "GreenTech",
                  "phone": "555-0106"
                }
              ]
            },
            "description": "Create temp input file with test data"
          },
          {
            "step_number": 3,
            "method": "run_etl_pipeline",
            "parameters": {
              "source_file": null
            },
            "description": "Run ETL pipeline with test data"
          },
          {
            "step_number": 4,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id = 'C006' AND is_current = true;"
            },
            "description": "Validation query 1"
          },
          {
            "step_number": 5,
            "method": "cleanup_temp_file",
            "parameters": {},
            "description": "Cleanup temp files"
          },
          {
            "step_number": 6,
            "method": "restore_from_backup",
            "parameters": {},
            "description": "Restore table from backup"
          }
        ],
        "validation": {
          "method": "check_outcome",
          "expected": "A new record for customer C006 is inserted into the dim_customer table with is_current set to true."
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "create_backup",
          "success": true,
          "result": "Backup created"
        },
        {
          "step_number": 2,
          "method": "create_temp_input_file",
          "success": true,
          "result": "Temp file created"
        },
        {
          "step_number": 3,
          "method": "run_etl_pipeline",
          "success": true,
          "result": "{'inserted': 0, 'updated_scd2': 1, 'updated_scd1': 0, 'unchanged': 0}"
        },
        {
          "step_number": 4,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 1}]"
        },
        {
          "step_number": 5,
          "method": "cleanup_temp_file",
          "success": true,
          "result": "Temp file removed"
        },
        {
          "step_number": 6,
          "method": "restore_from_backup",
          "success": true,
          "result": "Table restored"
        }
      ],
      "actual_result": "[{'count': 1}]",
      "expected_result": "A new record for customer C006 is inserted into the dim_customer table with is_current set to true.",
      "validation_message": "Validation passed: Found 1 records",
      "error_message": null
    },
    {
      "test_id": "SC002",
      "test_name": "Company Name Change (SCD Type 2)",
      "test_type": "scenario_check",
      "severity": "high",
      "status": "passed",
      "execution_timestamp": "2026-01-31 15:28:46",
      "execution_time_seconds": 6.31,
      "execution_plan": {
        "test_id": "SC002",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "create_backup",
            "parameters": {},
            "description": "Backup current table state"
          },
          {
            "step_number": 2,
            "method": "create_temp_input_file",
            "parameters": {
              "input_data": [
                {
                  "customer_id": "C001",
                  "first_name": "John",
                  "last_name": "Doe",
                  "email": "john.doe@email.com",
                  "company_name": "NewTech Industries",
                  "phone": "555-0101"
                }
              ]
            },
            "description": "Create temp input file with test data"
          },
          {
            "step_number": 3,
            "method": "run_etl_pipeline",
            "parameters": {
              "source_file": null
            },
            "description": "Run ETL pipeline with test data"
          },
          {
            "step_number": 4,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id = 'C001' AND is_current = false;"
            },
            "description": "Validation query 1"
          },
          {
            "step_number": 5,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id = 'C001' AND company_name = 'NewTech Industries' AND is_current = true;"
            },
            "description": "Validation query 2"
          },
          {
            "step_number": 6,
            "method": "cleanup_temp_file",
            "parameters": {},
            "description": "Cleanup temp files"
          },
          {
            "step_number": 7,
            "method": "restore_from_backup",
            "parameters": {},
            "description": "Restore table from backup"
          }
        ],
        "validation": {
          "method": "check_outcome",
          "expected": "A new record for customer C001 is created with the new company name, and the previous record is marked as not current."
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "create_backup",
          "success": true,
          "result": "Backup created"
        },
        {
          "step_number": 2,
          "method": "create_temp_input_file",
          "success": true,
          "result": "Temp file created"
        },
        {
          "step_number": 3,
          "method": "run_etl_pipeline",
          "success": true,
          "result": "{'inserted': 0, 'updated_scd2': 1, 'updated_scd1': 0, 'unchanged': 0}"
        },
        {
          "step_number": 4,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 2}]"
        },
        {
          "step_number": 5,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 1}]"
        },
        {
          "step_number": 6,
          "method": "cleanup_temp_file",
          "success": true,
          "result": "Temp file removed"
        },
        {
          "step_number": 7,
          "method": "restore_from_backup",
          "success": true,
          "result": "Table restored"
        }
      ],
      "actual_result": "[{'count': 1}]",
      "expected_result": "A new record for customer C001 is created with the new company name, and the previous record is marked as not current.",
      "validation_message": "Validation passed: Found 1 records",
      "error_message": null
    },
    {
      "test_id": "SC003",
      "test_name": "Name/Email/Phone Change (SCD Type 1)",
      "test_type": "scenario_check",
      "severity": "medium",
      "status": "passed",
      "execution_timestamp": "2026-01-31 15:28:52",
      "execution_time_seconds": 7.56,
      "execution_plan": {
        "test_id": "SC003",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "create_backup",
            "parameters": {},
            "description": "Backup current table state"
          },
          {
            "step_number": 2,
            "method": "create_temp_input_file",
            "parameters": {
              "input_data": [
                {
                  "customer_id": "C002",
                  "first_name": "Jane",
                  "last_name": "Doe",
                  "email": "jane.doe@email.com",
                  "company_name": "MegaData Corp",
                  "phone": "555-0107"
                }
              ]
            },
            "description": "Create temp input file with test data"
          },
          {
            "step_number": 3,
            "method": "run_etl_pipeline",
            "parameters": {
              "source_file": null
            },
            "description": "Run ETL pipeline with test data"
          },
          {
            "step_number": 4,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT first_name, last_name, email, phone FROM dim_customer WHERE customer_id = 'C002';"
            },
            "description": "Validation query 1"
          },
          {
            "step_number": 5,
            "method": "cleanup_temp_file",
            "parameters": {},
            "description": "Cleanup temp files"
          },
          {
            "step_number": 6,
            "method": "restore_from_backup",
            "parameters": {},
            "description": "Restore table from backup"
          }
        ],
        "validation": {
          "method": "check_outcome",
          "expected": "The existing record for customer C002 is updated with the new name, email, and phone number."
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "create_backup",
          "success": true,
          "result": "Backup created"
        },
        {
          "step_number": 2,
          "method": "create_temp_input_file",
          "success": true,
          "result": "Temp file created"
        },
        {
          "step_number": 3,
          "method": "run_etl_pipeline",
          "success": true,
          "result": "{'inserted': 0, 'updated_scd2': 0, 'updated_scd1': 1, 'unchanged': 0}"
        },
        {
          "step_number": 4,
          "method": "execute_query",
          "success": true,
          "result": "[{'first_name': 'Jane', 'last_name': 'Smith', 'email': 'jane.smith@email.com', 'phone': '555-0102'}, {'first_name': 'Jane', 'last_name': 'Doe', 'email': 'jane.doe@email.com', 'phone': '555-0107'}]"
        },
        {
          "step_number": 5,
          "method": "cleanup_temp_file",
          "success": true,
          "result": "Temp file removed"
        },
        {
          "step_number": 6,
          "method": "restore_from_backup",
          "success": true,
          "result": "Table restored"
        }
      ],
      "actual_result": "[{'first_name': 'Jane', 'last_name': 'Smith', 'email': 'jane.smith@email.com', 'phone': '555-0102'}, {'first_name': 'Jane', 'last_name': 'Doe', 'email': 'jane.doe@email.com', 'phone': '555-0107'}]",
      "expected_result": "The existing record for customer C002 is updated with the new name, email, and phone number.",
      "validation_message": "Validation passed: Found 2 records",
      "error_message": null
    },
    {
      "test_id": "SC004",
      "test_name": "Combined Type 1 + Type 2 Changes",
      "test_type": "scenario_check",
      "severity": "high",
      "status": "passed",
      "execution_timestamp": "2026-01-31 15:29:00",
      "execution_time_seconds": 6.26,
      "execution_plan": {
        "test_id": "SC004",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "create_backup",
            "parameters": {},
            "description": "Backup current table state"
          },
          {
            "step_number": 2,
            "method": "create_temp_input_file",
            "parameters": {
              "input_data": [
                {
                  "customer_id": "C003",
                  "first_name": "Michael",
                  "last_name": "Johnson",
                  "email": "michael.new@email.com",
                  "company_name": "CloudBase Solutions",
                  "phone": "555-0103"
                }
              ]
            },
            "description": "Create temp input file with test data"
          },
          {
            "step_number": 3,
            "method": "run_etl_pipeline",
            "parameters": {
              "source_file": null
            },
            "description": "Run ETL pipeline with test data"
          },
          {
            "step_number": 4,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id = 'C003' AND is_current = false;"
            },
            "description": "Validation query 1"
          },
          {
            "step_number": 5,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id = 'C003' AND email = 'michael.new@email.com' AND is_current = true;"
            },
            "description": "Validation query 2"
          },
          {
            "step_number": 6,
            "method": "cleanup_temp_file",
            "parameters": {},
            "description": "Cleanup temp files"
          },
          {
            "step_number": 7,
            "method": "restore_from_backup",
            "parameters": {},
            "description": "Restore table from backup"
          }
        ],
        "validation": {
          "method": "check_outcome",
          "expected": "A new record for customer C003 is created with the new company name and email, and the previous record is marked as not current."
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "create_backup",
          "success": true,
          "result": "Backup created"
        },
        {
          "step_number": 2,
          "method": "create_temp_input_file",
          "success": true,
          "result": "Temp file created"
        },
        {
          "step_number": 3,
          "method": "run_etl_pipeline",
          "success": true,
          "result": "{'inserted': 0, 'updated_scd2': 1, 'updated_scd1': 0, 'unchanged': 0}"
        },
        {
          "step_number": 4,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 1}]"
        },
        {
          "step_number": 5,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 1}]"
        },
        {
          "step_number": 6,
          "method": "cleanup_temp_file",
          "success": true,
          "result": "Temp file removed"
        },
        {
          "step_number": 7,
          "method": "restore_from_backup",
          "success": true,
          "result": "Table restored"
        }
      ],
      "actual_result": "[{'count': 1}]",
      "expected_result": "A new record for customer C003 is created with the new company name and email, and the previous record is marked as not current.",
      "validation_message": "Validation passed: Found 1 records",
      "error_message": null
    },
    {
      "test_id": "SC005",
      "test_name": "Multiple Sequential Changes to Same Customer",
      "test_type": "scenario_check",
      "severity": "medium",
      "status": "passed",
      "execution_timestamp": "2026-01-31 15:29:06",
      "execution_time_seconds": 6.92,
      "execution_plan": {
        "test_id": "SC005",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "create_backup",
            "parameters": {},
            "description": "Backup current table state"
          },
          {
            "step_number": 2,
            "method": "create_temp_input_file",
            "parameters": {
              "input_data": [
                {
                  "customer_id": "C001",
                  "first_name": "John",
                  "last_name": "Doe",
                  "email": "john.doe@email.com",
                  "company_name": "TechCorp Inc",
                  "phone": "555-0101"
                },
                {
                  "customer_id": "C001",
                  "first_name": "John",
                  "last_name": "Doe",
                  "email": "john.updated@email.com",
                  "company_name": "TechCorp Inc",
                  "phone": "555-0108"
                }
              ]
            },
            "description": "Create temp input file with test data"
          },
          {
            "step_number": 3,
            "method": "run_etl_pipeline",
            "parameters": {
              "source_file": null
            },
            "description": "Run ETL pipeline with test data"
          },
          {
            "step_number": 4,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id = 'C001' AND is_current = false;"
            },
            "description": "Validation query 1"
          },
          {
            "step_number": 5,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id = 'C001' AND email = 'john.updated@email.com' AND is_current = true;"
            },
            "description": "Validation query 2"
          },
          {
            "step_number": 6,
            "method": "cleanup_temp_file",
            "parameters": {},
            "description": "Cleanup temp files"
          },
          {
            "step_number": 7,
            "method": "restore_from_backup",
            "parameters": {},
            "description": "Restore table from backup"
          }
        ],
        "validation": {
          "method": "check_outcome",
          "expected": "Two records for customer C001 are created, with the first record marked as not current and the second record as current."
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "create_backup",
          "success": true,
          "result": "Backup created"
        },
        {
          "step_number": 2,
          "method": "create_temp_input_file",
          "success": true,
          "result": "Temp file created"
        },
        {
          "step_number": 3,
          "method": "run_etl_pipeline",
          "success": true,
          "result": "{'inserted': 0, 'updated_scd2': 1, 'updated_scd1': 1, 'unchanged': 0}"
        },
        {
          "step_number": 4,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 2}]"
        },
        {
          "step_number": 5,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 1}]"
        },
        {
          "step_number": 6,
          "method": "cleanup_temp_file",
          "success": true,
          "result": "Temp file removed"
        },
        {
          "step_number": 7,
          "method": "restore_from_backup",
          "success": true,
          "result": "Table restored"
        }
      ],
      "actual_result": "[{'count': 1}]",
      "expected_result": "Two records for customer C001 are created, with the first record marked as not current and the second record as current.",
      "validation_message": "Validation passed: Found 1 records",
      "error_message": null
    },
    {
      "test_id": "SC006",
      "test_name": "Unchanged Records",
      "test_type": "scenario_check",
      "severity": "low",
      "status": "passed",
      "execution_timestamp": "2026-01-31 15:29:13",
      "execution_time_seconds": 7.98,
      "execution_plan": {
        "test_id": "SC006",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "create_backup",
            "parameters": {},
            "description": "Backup current table state"
          },
          {
            "step_number": 2,
            "method": "create_temp_input_file",
            "parameters": {
              "input_data": [
                {
                  "customer_id": "C003",
                  "first_name": "Michael",
                  "last_name": "Johnson",
                  "email": "michael.j@email.com",
                  "company_name": "CloudBase Systems",
                  "phone": "555-0103"
                }
              ]
            },
            "description": "Create temp input file with test data"
          },
          {
            "step_number": 3,
            "method": "run_etl_pipeline",
            "parameters": {
              "source_file": null
            },
            "description": "Run ETL pipeline with test data"
          },
          {
            "step_number": 4,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id = 'C003' AND is_current = true;"
            },
            "description": "Validation query 1"
          },
          {
            "step_number": 5,
            "method": "cleanup_temp_file",
            "parameters": {},
            "description": "Cleanup temp files"
          },
          {
            "step_number": 6,
            "method": "restore_from_backup",
            "parameters": {},
            "description": "Restore table from backup"
          }
        ],
        "validation": {
          "method": "check_outcome",
          "expected": "The record for customer C003 remains unchanged in the dim_customer table."
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "create_backup",
          "success": true,
          "result": "Backup created"
        },
        {
          "step_number": 2,
          "method": "create_temp_input_file",
          "success": true,
          "result": "Temp file created"
        },
        {
          "step_number": 3,
          "method": "run_etl_pipeline",
          "success": true,
          "result": "{'inserted': 0, 'updated_scd2': 0, 'updated_scd1': 0, 'unchanged': 1}"
        },
        {
          "step_number": 4,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 1}]"
        },
        {
          "step_number": 5,
          "method": "cleanup_temp_file",
          "success": true,
          "result": "Temp file removed"
        },
        {
          "step_number": 6,
          "method": "restore_from_backup",
          "success": true,
          "result": "Table restored"
        }
      ],
      "actual_result": "[{'count': 1}]",
      "expected_result": "The record for customer C003 remains unchanged in the dim_customer table.",
      "validation_message": "Validation passed: Found 1 records",
      "error_message": null
    },
    {
      "test_id": "SC007",
      "test_name": "New Customer + Existing Customer Updates",
      "test_type": "scenario_check",
      "severity": "high",
      "status": "passed",
      "execution_timestamp": "2026-01-31 15:29:21",
      "execution_time_seconds": 6.42,
      "execution_plan": {
        "test_id": "SC007",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "create_backup",
            "parameters": {},
            "description": "Backup current table state"
          },
          {
            "step_number": 2,
            "method": "create_temp_input_file",
            "parameters": {
              "input_data": [
                {
                  "customer_id": "C004",
                  "first_name": "Emily",
                  "last_name": "Williams",
                  "email": "emily.w@email.com",
                  "company_name": "TechCorp Inc",
                  "phone": "555-0104"
                },
                {
                  "customer_id": "C002",
                  "first_name": "Jane",
                  "last_name": "Doe",
                  "email": "jane.doe@email.com",
                  "company_name": "DataSoft LLC",
                  "phone": "555-0109"
                }
              ]
            },
            "description": "Create temp input file with test data"
          },
          {
            "step_number": 3,
            "method": "run_etl_pipeline",
            "parameters": {
              "source_file": null
            },
            "description": "Run ETL pipeline with test data"
          },
          {
            "step_number": 4,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id = 'C004' AND is_current = true;"
            },
            "description": "Validation query 1"
          },
          {
            "step_number": 5,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT phone FROM dim_customer WHERE customer_id = 'C002';"
            },
            "description": "Validation query 2"
          },
          {
            "step_number": 6,
            "method": "cleanup_temp_file",
            "parameters": {},
            "description": "Cleanup temp files"
          },
          {
            "step_number": 7,
            "method": "restore_from_backup",
            "parameters": {},
            "description": "Restore table from backup"
          }
        ],
        "validation": {
          "method": "check_outcome",
          "expected": "A new record for customer C004 is inserted, and the record for customer C002 is updated with the new phone number."
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "create_backup",
          "success": true,
          "result": "Backup created"
        },
        {
          "step_number": 2,
          "method": "create_temp_input_file",
          "success": true,
          "result": "Temp file created"
        },
        {
          "step_number": 3,
          "method": "run_etl_pipeline",
          "success": true,
          "result": "{'inserted': 0, 'updated_scd2': 2, 'updated_scd1': 0, 'unchanged': 0}"
        },
        {
          "step_number": 4,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 1}]"
        },
        {
          "step_number": 5,
          "method": "execute_query",
          "success": true,
          "result": "[{'phone': '555-0102'}, {'phone': '555-0102'}, {'phone': '555-0109'}]"
        },
        {
          "step_number": 6,
          "method": "cleanup_temp_file",
          "success": true,
          "result": "Temp file removed"
        },
        {
          "step_number": 7,
          "method": "restore_from_backup",
          "success": true,
          "result": "Table restored"
        }
      ],
      "actual_result": "[{'phone': '555-0102'}, {'phone': '555-0102'}, {'phone': '555-0109'}]",
      "expected_result": "A new record for customer C004 is inserted, and the record for customer C002 is updated with the new phone number.",
      "validation_message": "Validation passed: Found 3 records",
      "error_message": null
    },
    {
      "test_id": "SC008",
      "test_name": "Edge Cases with Empty Values",
      "test_type": "scenario_check",
      "severity": "medium",
      "status": "passed",
      "execution_timestamp": "2026-01-31 15:29:27",
      "execution_time_seconds": 7.6,
      "execution_plan": {
        "test_id": "SC008",
        "execution_steps": [
          {
            "step_number": 1,
            "method": "create_backup",
            "parameters": {},
            "description": "Backup current table state"
          },
          {
            "step_number": 2,
            "method": "create_temp_input_file",
            "parameters": {
              "input_data": [
                {
                  "customer_id": "C005",
                  "first_name": "",
                  "last_name": "Brown",
                  "email": "david.b@email.com",
                  "company_name": "InnovateTech",
                  "phone": "555-0105"
                },
                {
                  "customer_id": "C006",
                  "first_name": "Alice",
                  "last_name": "Green",
                  "email": "alice.green@email.com",
                  "company_name": "Green@Tech",
                  "phone": "555-0106"
                }
              ]
            },
            "description": "Create temp input file with test data"
          },
          {
            "step_number": 3,
            "method": "run_etl_pipeline",
            "parameters": {
              "source_file": null
            },
            "description": "Run ETL pipeline with test data"
          },
          {
            "step_number": 4,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id = 'C005' AND first_name = '';"
            },
            "description": "Validation query 1"
          },
          {
            "step_number": 5,
            "method": "execute_query",
            "parameters": {
              "query": "SELECT COUNT(*) FROM dim_customer WHERE customer_id = 'C006' AND company_name = 'Green@Tech';"
            },
            "description": "Validation query 2"
          },
          {
            "step_number": 6,
            "method": "cleanup_temp_file",
            "parameters": {},
            "description": "Cleanup temp files"
          },
          {
            "step_number": 7,
            "method": "restore_from_backup",
            "parameters": {},
            "description": "Restore table from backup"
          }
        ],
        "validation": {
          "method": "check_outcome",
          "expected": "Records are inserted or updated correctly, with the first name of C005 being empty and the company name of C006 containing a special character."
        }
      },
      "step_results": [
        {
          "step_number": 1,
          "method": "create_backup",
          "success": true,
          "result": "Backup created"
        },
        {
          "step_number": 2,
          "method": "create_temp_input_file",
          "success": true,
          "result": "Temp file created"
        },
        {
          "step_number": 3,
          "method": "run_etl_pipeline",
          "success": true,
          "result": "{'inserted': 0, 'updated_scd2': 1, 'updated_scd1': 1, 'unchanged': 0}"
        },
        {
          "step_number": 4,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 1}]"
        },
        {
          "step_number": 5,
          "method": "execute_query",
          "success": true,
          "result": "[{'count': 1}]"
        },
        {
          "step_number": 6,
          "method": "cleanup_temp_file",
          "success": true,
          "result": "Temp file removed"
        },
        {
          "step_number": 7,
          "method": "restore_from_backup",
          "success": true,
          "result": "Table restored"
        }
      ],
      "actual_result": "[{'count': 1}]",
      "expected_result": "Records are inserted or updated correctly, with the first name of C005 being empty and the company name of C006 containing a special character.",
      "validation_message": "Validation passed: Found 1 records",
      "error_message": null
    }
  ]
}